# ğŸ“ PhÃ¢n TÃ­ch: Táº¡o Online Test Tá»« Conversation Vocabulary & Grammar

**NgÃ y táº¡o:** 14/02/2026
**TÃ¡c giáº£:** GitHub Copilot
**Má»¥c Ä‘Ã­ch:** PhÃ¢n tÃ­ch kháº£ nÄƒng táº¡o online test tá»± Ä‘á»™ng tá»« vocabulary vÃ  grammar cá»§a má»—i conversation

---

## ğŸ¯ Tá»•ng Quan Äá» Xuáº¥t

### Ã TÆ°á»Ÿng ChÃ­nh
Tá»± Ä‘á»™ng táº¡o **1 online test** cho má»—i conversation dá»±a trÃªn:
- âœ… **Vocabulary** Ä‘Ã£ Ä‘Æ°á»£c lÆ°u (8-15 tá»«)
- âœ… **Grammar points** Ä‘Ã£ Ä‘Æ°á»£c lÆ°u (3-6 patterns)
- âœ… Sá»­ dá»¥ng **DeepSeek** Ä‘á»ƒ generate cÃ¢u há»i JSON
- âœ… LÆ°u vÃ o **collection `online_tests`** (Ä‘Ã£ cÃ³ sáºµn)
- âœ… Cover image tá»« **Gemini 3 Pro** (image generation)
- âœ… Link test (slug) Ä‘Æ°á»£c lÆ°u vÃ o conversation document

---

## ğŸ“Š PhÃ¢n TÃ­ch Database Hiá»‡n Táº¡i

### 1. **Collection: `conversation_library`** (1,739 conversations)

**Dá»¯ liá»‡u cÃ³ sáºµn:**
```javascript
{
  conversation_id: "conv_beginner_greetings_01_001",
  level: "beginner",  // beginner, intermediate, advanced
  topic: "greetings_introductions",
  title: {en: "Hello, How Are You?", vi: "Xin chÃ o, Báº¡n khá»e khÃ´ng?"},
  situation: "Two friends meeting on the street",
  dialogue: [...],  // 6-16 turns
  word_count: 89,
  turn_count: 8,
  // âš ï¸ CHÆ¯A CÃ“: online_test_id hoáº·c test_slug
}
```

**Cáº§n thÃªm field:**
```javascript
{
  ...
  online_test_id: ObjectId("..."),  // Link tá»›i online_tests collection
  online_test_slug: "test-beginner-greetings-001",  // Slug Ä‘á»ƒ share
  has_online_test: true  // Boolean Ä‘á»ƒ query nhanh
}
```

---

### 2. **Collection: `conversation_vocabulary`** (1,739 vocab documents)

**Dá»¯ liá»‡u cÃ³ sáºµn:**
```javascript
{
  vocab_id: "vocab_conv_beginner_greetings_01_001",
  conversation_id: "conv_beginner_greetings_01_001",

  // ğŸ“š VOCABULARY (8-15 items)
  vocabulary: [
    {
      word: "greet",
      definition_en: "To say hello or welcome someone",
      definition_vi: "ChÃ o há»i",
      example: "I greet my friend every morning",
      pos_tag: "VERB"
    },
    // ... 7-14 more words
  ],

  // ğŸ“– GRAMMAR (3-6 patterns)
  grammar_points: [
    {
      pattern: "How are you?",
      explanation_en: "Common greeting question",
      explanation_vi: "CÃ¢u há»i chÃ o há»i phá»• biáº¿n",
      example: "Hi John, how are you today?"
    },
    // ... 2-5 more patterns
  ],

  generated_by: "deepseek-v3",
  generated_at: ISODate("...")
}
```

**ğŸ’¡ Insight:** ÄÃ¢y lÃ  nguá»“n dá»¯ liá»‡u CHÃNH Ä‘á»ƒ táº¡o test!

---

### 3. **Collection: `online_tests`** (ÄÃ£ cÃ³ sáºµn - sá»­ dá»¥ng láº¡i)

**Schema chuáº©n:**
```javascript
{
  _id: ObjectId("..."),
  title: "Test: Hello, How Are You? - Vocabulary & Grammar",
  description: "Test your understanding of greetings vocabulary and grammar patterns",

  // METADATA
  creator_id: "wordai_team",  // â­ System-generated tests
  creator_name: "WordAI Team",
  test_type: "mcq",  // Multiple choice only
  test_category: "academic",  // Knowledge-based with correct answers
  status: "ready",
  is_active: true,

  // CONVERSATION LINK (NEW FIELDS)
  source_type: "conversation",  // â­ NEW type
  conversation_id: "conv_beginner_greetings_01_001",  // â­ Link back
  conversation_level: "beginner",  // For filtering
  conversation_topic: "greetings_introductions",

  // TEST CONFIG
  time_limit_minutes: 10,  // Beginner: 10, Inter: 15, Adv: 20
  max_retries: 3,
  passing_score: 70,
  show_answers_timing: "immediate",

  // QUESTIONS (10-25 cÃ¢u tÃ¹y level)
  questions: [
    {
      question_id: "q1",
      question_type: "mcq",
      question_text: "What does 'greet' mean?",
      options: [
        "To say hello",  // âœ… Correct
        "To say goodbye",
        "To ask a question",
        "To make a request"
      ],
      correct_answers: ["To say hello"],
      explanation: "The word 'greet' means to say hello or welcome someone.",
      max_points: 1
    },
    {
      question_id: "q2",
      question_type: "mcq",
      question_text: "Which sentence uses 'How are you?' correctly?",
      options: [
        "How are you today?",  // âœ… Correct
        "How you are today?",
        "How is you today?",
        "You how are today?"
      ],
      correct_answers: ["How are you today?"],
      explanation: "The correct word order is 'How are you?'",
      max_points: 1
    },
    // ... 8-23 more questions
  ],

  // MARKETPLACE (Optional - cÃ³ thá»ƒ bÃ¡n sau)
  marketplace_config: {
    is_published: false,  // Default khÃ´ng publish
    price_points: 0,  // Free for conversation learners
    category: "English Learning - Conversations",
    tags: "beginner,vocabulary,grammar,conversation"
  },

  // COVER IMAGE (Generated by Gemini)
  cover_image_url: "https://static.wordai.pro/test-covers/conv-beginner-greetings-001.png",

  // TIMESTAMPS
  created_at: ISODate("..."),
  updated_at: ISODate("..."),
  generated_at: ISODate("...")
}
```

---

## ğŸ¨ PhÃ¢n TÃ­ch Theo 3 Cáº¥p Äá»™

### **Level 1: Beginner** (600 conversations)

**Test Structure:**
- âœ… **10 cÃ¢u há»i** (Ä‘Æ¡n giáº£n, dá»… hiá»ƒu)
- âœ… **Thá»i gian:** 10 phÃºt
- âœ… **Question types:**
  - 6 cÃ¢u vocabulary (definition, usage, synonyms)
  - 4 cÃ¢u grammar (pattern recognition, sentence completion)

**VÃ­ dá»¥ cÃ¢u há»i:**

**1. Vocabulary Definition (4 cÃ¢u)**
```
Q: What does "greet" mean?
A) To say hello âœ…
B) To say goodbye
C) To ask a question
D) To make a request
```

**2. Vocabulary Usage (2 cÃ¢u)**
```
Q: Choose the correct sentence using "morning":
A) I wake up in the morning âœ…
B) I wake up on the morning
C) I wake up at the morning
D) I wake up to the morning
```

**3. Grammar Pattern (2 cÃ¢u)**
```
Q: What is the correct way to ask about someone's wellbeing?
A) How are you? âœ…
B) How you are?
C) How is you?
D) You how are?
```

**4. Fill in the Blank (2 cÃ¢u)**
```
Q: Complete: "Nice _____ meet you!"
A) to âœ…
B) for
C) at
D) on
```

---

### **Level 2: Intermediate** (600 conversations)

**Test Structure:**
- âœ… **15-20 cÃ¢u há»i** (phá»©c táº¡p hÆ¡n)
- âœ… **Thá»i gian:** 15 phÃºt
- âœ… **Question types:**
  - 8 cÃ¢u vocabulary (nuances, collocations, context)
  - 7 cÃ¢u grammar (tense usage, sentence structure)
  - 5 cÃ¢u reading comprehension (tá»« dialogue trong conversation)

**VÃ­ dá»¥ cÃ¢u há»i:**

**1. Vocabulary Nuance (3 cÃ¢u)**
```
Q: What's the difference between "arrange" and "organize"?
A) Arrange is for physical placement, organize is for systems âœ…
B) They mean exactly the same thing
C) Arrange is formal, organize is informal
D) Organize is only for events
```

**2. Collocation (2 cÃ¢u)**
```
Q: Which phrase is correct?
A) Make an appointment âœ…
B) Do an appointment
C) Take an appointment
D) Have an appointment
```

**3. Grammar Tense (3 cÃ¢u)**
```
Q: "I _____ to the gym three times a week." (Present Simple - habit)
A) go âœ…
B) am going
C) went
D) have gone
```

**4. Dialogue Comprehension (2 cÃ¢u)**
```
Q: In the conversation, why did Sarah say "I'd be happy to help"?
A) She volunteered to assist Mark âœ…
B) She was asking for help
C) She was refusing to help
D) She was complaining
```

---

### **Level 3: Advanced** (539+ conversations)

**Test Structure:**
- âœ… **20-25 cÃ¢u há»i** (nÃ¢ng cao, phÃ¢n tÃ­ch sÃ¢u)
- âœ… **Thá»i gian:** 20-25 phÃºt
- âœ… **Question types:**
  - 10 cÃ¢u vocabulary (idiomatic usage, formal/informal register)
  - 8 cÃ¢u grammar (complex structures, subjunctive, conditionals)
  - 7 cÃ¢u discourse analysis (conversation flow, pragmatics)

**VÃ­ dá»¥ cÃ¢u há»i:**

**1. Idiomatic Expression (3 cÃ¢u)**
```
Q: What does "navigate the legal landscape" mean in business context?
A) Understand and comply with laws and regulations âœ…
B) Travel to different countries
C) Study geography
D) Hire a lawyer
```

**2. Register & Formality (2 cÃ¢u)**
```
Q: Which phrase is MORE formal for business emails?
A) I would like to request your assistance âœ…
B) Can you help me out?
C) I need you to help
D) Help me please
```

**3. Complex Grammar (3 cÃ¢u)**
```
Q: "Had the company _____ earlier, they could have avoided bankruptcy."
A) acted âœ… (Past perfect conditional - inversion)
B) act
C) been acting
D) to act
```

**4. Pragmatic Analysis (2 cÃ¢u)**
```
Q: Why did Dr. Chen say "That's an interesting perspective" instead of agreeing?
A) Polite disagreement/hedging âœ…
B) Full agreement
C) Complete disagreement
D) Changing the topic
```

---

## ğŸ¤– DeepSeek Prompt Strategy

### Template Prompt (Táº¡o 10-25 cÃ¢u há»i JSON)

```
Generate {num_questions} multiple-choice questions for an English learning test at {level} level.

SOURCE: Conversation - "{conversation_title}"
VOCABULARY: {vocabulary_json}
GRAMMAR: {grammar_json}

REQUIREMENTS:
1. Question Distribution:
   - Vocabulary questions: {vocab_count}
   - Grammar questions: {grammar_count}
   - {additional_types if intermediate/advanced}

2. Question Types by Level:
   {level_specific_requirements}

3. Difficulty:
   - {level}: {difficulty_description}
   - Clear correct answer
   - Plausible distractors (wrong options)

4. Vietnamese Support:
   - Question text: English
   - Explanation: Both English & Vietnamese

OUTPUT FORMAT (JSON):
{
  "questions": [
    {
      "question_id": "q1",
      "question_type": "mcq",
      "question_text": "What does 'greet' mean?",
      "options": [
        "To say hello",
        "To say goodbye",
        "To ask a question",
        "To make a request"
      ],
      "correct_answers": ["To say hello"],
      "explanation": "The word 'greet' means to say hello or welcome someone. | Tá»« 'greet' cÃ³ nghÄ©a lÃ  chÃ o há»i hoáº·c chÃ o Ä‘Ã³n ai Ä‘Ã³.",
      "max_points": 1,
      "difficulty": "{level}",
      "tags": ["vocabulary", "definition"]
    }
  ]
}
```

**Level-Specific Requirements:**

**Beginner (10 cÃ¢u):**
```
- 4 cÃ¢u: Vocabulary definition (nghÄ©a cá»§a tá»«)
- 2 cÃ¢u: Vocabulary usage (sá»­ dá»¥ng trong cÃ¢u)
- 2 cÃ¢u: Grammar pattern recognition (nháº­n biáº¿t cáº¥u trÃºc)
- 2 cÃ¢u: Fill in the blank (Ä‘iá»n vÃ o chá»— trá»‘ng)

Distractors: Obvious wrong answers, clear differences
Language: Simple, direct questions
```

**Intermediate (15-20 cÃ¢u):**
```
- 3 cÃ¢u: Vocabulary nuances (sá»± khÃ¡c biá»‡t nghÄ©a)
- 2 cÃ¢u: Collocations (káº¿t há»£p tá»«)
- 3 cÃ¢u: Synonyms/Antonyms
- 3 cÃ¢u: Grammar tense usage
- 2 cÃ¢u: Sentence structure
- 2 cÃ¢u: Dialogue comprehension (hiá»ƒu há»™i thoáº¡i)
- 5 cÃ¢u: Context-based questions

Distractors: Plausible but incorrect options
Language: Moderate complexity
```

**Advanced (20-25 cÃ¢u):**
```
- 3 cÃ¢u: Idiomatic expressions
- 2 cÃ¢u: Formal/Informal register
- 3 cÃ¢u: Vocabulary in context (business, academic)
- 3 cÃ¢u: Complex grammar (subjunctive, conditionals, inversion)
- 3 cÃ¢u: Grammar advanced structures
- 2 cÃ¢u: Discourse markers
- 2 cÃ¢u: Pragmatic analysis (táº¡i sao nÃ³i nhÆ° váº­y?)
- 7 cÃ¢u: Critical thinking questions

Distractors: Subtle differences, requires deep understanding
Language: Academic/Professional level
```

---

## ğŸ–¼ï¸ Gemini Image Generation Strategy

### Cover Image Prompt Template

```
Generate a professional, colorful cover image for an English learning test.

TEST DETAILS:
- Title: "{conversation_title}"
- Level: {level} (Beginner/Intermediate/Advanced)
- Topic: {topic_display}
- Type: Vocabulary & Grammar Test

VISUAL STYLE:
- Modern, clean design
- Educational theme
- {level_color_scheme}:
  * Beginner: Soft blues and greens (calming, approachable)
  * Intermediate: Warm oranges and yellows (energetic, engaging)
  * Advanced: Deep purples and teals (sophisticated, professional)
- Include: Book icon, graduation cap, or conversation bubbles
- Text overlay: "{conversation_title}" in clear, readable font
- Aspect ratio: 16:9 (landscape for web display)
- Resolution: 1280x720px

NO TEXT IN IMAGE (text will be overlaid by design team)
NO PEOPLE (avoid copyright issues)
ABSTRACT/MINIMAL style preferred
```

**Upload Flow:**
1. Generate image vá»›i Gemini 3 Pro
2. Upload to R2: `test-covers/conv-{level}-{topic}-{index}.png`
3. LÆ°u URL: `https://static.wordai.pro/test-covers/...`
4. Update `online_tests.cover_image_url`

---

## ğŸ”— Database Schema Updates

### 1. Update `conversation_library` Collection

**Add new fields:**
```javascript
db.conversation_library.updateMany(
  {},
  {
    $set: {
      online_test_id: null,  // Will be set after test generation
      online_test_slug: null,  // e.g., "test-beginner-greetings-001"
      has_online_test: false
    }
  }
)
```

**Index:**
```javascript
db.conversation_library.createIndex({ has_online_test: 1 })
db.conversation_library.createIndex({ online_test_slug: 1 }, { unique: true, sparse: true })
```

---

### 2. Update `online_tests` Collection

**Add new index for conversation tests:**
```javascript
db.online_tests.createIndex({ source_type: 1 })
db.online_tests.createIndex({ conversation_id: 1 }, { unique: true, sparse: true })
db.online_tests.createIndex({ conversation_level: 1, conversation_topic: 1 })
```

**Find conversation tests:**
```javascript
db.online_tests.find({ source_type: "conversation" })
db.online_tests.find({ conversation_level: "beginner" })
```

---

## ğŸ“‹ Implementation Flow - Step by Step

### **Step 1: Chuáº©n bá»‹ Database**

**File:** `crawler/add_conversation_test_fields.py`

```python
from src.database.db_manager import DBManager

db_manager = DBManager()
db = db_manager.db

# Add fields to conversation_library
result = db.conversation_library.update_many(
    {},
    {
        "$set": {
            "online_test_id": None,
            "online_test_slug": None,
            "has_online_test": False
        }
    }
)
print(f"âœ… Updated {result.modified_count} conversations")

# Create indexes
db.conversation_library.create_index("has_online_test")
db.conversation_library.create_index("online_test_slug", unique=True, sparse=True)

db.online_tests.create_index("source_type")
db.online_tests.create_index("conversation_id", unique=True, sparse=True)
db.online_tests.create_index([("conversation_level", 1), ("conversation_topic", 1)])

print("âœ… Indexes created")
```

**Run:**
```bash
docker exec ai-chatbot-rag python crawler/add_conversation_test_fields.py
```

---

### **Step 2: Táº¡o Test Generation Script**

**File:** `crawler/generate_conversation_tests.py`

**Key Functions:**

1. **`build_test_prompt(vocab_data, level, conversation_title)`**
   - Táº¡o DeepSeek prompt vá»›i vocabulary & grammar
   - TÃ¹y chá»‰nh theo level (10/15/20 cÃ¢u)

2. **`generate_test_questions(vocab_data, level, conversation_title)`**
   - Call DeepSeek API
   - Parse JSON response
   - Retry logic (3 attempts)

3. **`generate_cover_image(conversation_title, level, topic)`**
   - Call Gemini 3 Pro Image Generation
   - Upload to R2 storage
   - Return public URL

4. **`save_online_test(conversation_id, questions, cover_url, level, topic)`**
   - Create `online_tests` document
   - Set `source_type: "conversation"`
   - Set `creator_id: "wordai_team"`
   - Generate slug: `test-{level}-{topic}-{index}`

5. **`link_test_to_conversation(conversation_id, test_id, slug)`**
   - Update `conversation_library` document
   - Set `online_test_id`, `online_test_slug`, `has_online_test: true`

**Main Logic:**
```python
async def main():
    db_manager = DBManager()
    db = db_manager.db

    # Get all conversations without tests
    conversations = db.conversation_library.find({
        "has_online_test": {"$ne": True}
    })

    total = conversations.count()
    print(f"ğŸ“š Found {total} conversations without tests")

    semaphore = asyncio.Semaphore(5)  # 5 concurrent

    async def process_conversation(conv):
        async with semaphore:
            try:
                # Get vocabulary
                vocab = db.conversation_vocabulary.find_one({
                    "conversation_id": conv["conversation_id"]
                })

                if not vocab:
                    print(f"âš ï¸ No vocab for {conv['conversation_id']}")
                    return

                # Generate test questions
                questions = await generate_test_questions(
                    vocab_data=vocab,
                    level=conv["level"],
                    conversation_title=conv["title"]["en"]
                )

                # Generate cover image
                cover_url = await generate_cover_image(
                    conversation_title=conv["title"]["en"],
                    level=conv["level"],
                    topic=conv["topic_display"]["en"]
                )

                # Save test
                test_id, slug = await save_online_test(
                    conversation_id=conv["conversation_id"],
                    questions=questions,
                    cover_url=cover_url,
                    level=conv["level"],
                    topic=conv["topic"]
                )

                # Link back to conversation
                await link_test_to_conversation(
                    conversation_id=conv["conversation_id"],
                    test_id=test_id,
                    slug=slug
                )

                print(f"âœ… Created test: {slug}")

            except Exception as e:
                print(f"âŒ Error: {conv['conversation_id']} - {e}")

    # Process all conversations in parallel
    tasks = [process_conversation(conv) for conv in conversations]
    await asyncio.gather(*tasks)

    print(f"\nğŸ‰ Test generation complete!")
```

---

### **Step 3: Deploy & Run**

**Local Test (1 conversation):**
```bash
python crawler/generate_conversation_tests.py --limit 1
```

**Production Run (All 1,739):**
```bash
# Transfer script
scp crawler/generate_conversation_tests.py root@104.248.147.155:/home/hoile/wordai/crawler/

# Run in Docker (background)
ssh root@104.248.147.155 "docker cp /home/hoile/wordai/crawler/generate_conversation_tests.py ai-chatbot-rag:/app/crawler/ && docker exec -d ai-chatbot-rag python crawler/generate_conversation_tests.py"

# Monitor progress
ssh root@104.248.147.155 "docker logs -f ai-chatbot-rag | grep 'Created test'"

# Check completion
ssh root@104.248.147.155 "docker exec mongodb mongosh ai_service_db -u ai_service_user -p ai_service_2025_secure_password --authenticationDatabase admin --eval 'db.online_tests.countDocuments({source_type: \"conversation\"})'"
```

**Expected Time:**
- 5 concurrent requests
- ~10 seconds per test (DeepSeek + Gemini)
- Total: 1,739 tests Ã— 10s Ã· 5 = ~58 minutes

---

## ğŸ¯ Benefits & Use Cases

### **1. Há»c Vocabulary/Grammar Chá»§ Äá»™ng**
- User xem conversation â†’ Há»c tá»« vá»±ng â†’ LÃ m test ngay
- Reinforcement learning (há»c â†’ Ã´n â†’ kiá»ƒm tra)
- Immediate feedback vá»›i explanation

### **2. Gamification**
- Earn points khi pass test
- Leaderboard cho má»—i topic
- Unlock advanced conversations sau khi pass beginner tests

### **3. Marketplace Potential**
- CÃ³ thá»ƒ publish tests ra marketplace
- TÃ¡c giáº£: "WordAI Team" (credibility)
- Free for conversation learners, cÃ³ thá»ƒ charge cho external users

### **4. Progress Tracking**
- Link giá»¯a conversation progress vÃ  test scores
- "You scored 80% on Greetings vocabulary!"
- Recommend conversations dá»±a trÃªn weak areas

### **5. Adaptive Learning**
- Náº¿u user fail test â†’ Recommend lÃ m láº¡i conversation
- Náº¿u user pass â†’ Unlock next level conversation in topic

---

## âš ï¸ Challenges & Solutions

### **Challenge 1: Question Quality**
**Problem:** DeepSeek cÃ³ thá»ƒ táº¡o cÃ¢u há»i quÃ¡ dá»…/khÃ³ hoáº·c sai grammar
**Solution:**
- âœ… Validation step sau khi generate
- âœ… Manual review cho 10 tests Ä‘áº§u tiÃªn
- âœ… Retry vá»›i prompt cáº£i tiáº¿n náº¿u detect lá»—i
- âœ… Crowdsource feedback tá»« users (report bad questions)

### **Challenge 2: Image Generation Cost**
**Problem:** Gemini Image API cÃ³ thá»ƒ expensive cho 1,739 images
**Solution:**
- âœ… Alternative: Táº¡o templates vá»›i Figma, dÃ¹ng Playwright screenshot
- âœ… Reuse images cho cÃ¹ng topic (30 topics Ã— 3 levels = 90 unique images)
- âœ… Generate on-demand (lazy loading) thay vÃ¬ generate háº¿t

### **Challenge 3: Test Duplication**
**Problem:** Nhiá»u conversations cÃ³ vocabulary/grammar tÆ°Æ¡ng tá»±
**Solution:**
- âœ… Unique index trÃªn `conversation_id` trong `online_tests`
- âœ… Mix questions tá»« conversation-specific + general knowledge
- âœ… DeepSeek prompt: "Create UNIQUE questions based on this conversation"

### **Challenge 4: Maintenance**
**Problem:** Conversation content thay Ä‘á»•i â†’ Test outdated
**Solution:**
- âœ… Timestamp: `test_generated_from_vocab_version`
- âœ… Re-generate tests náº¿u vocabulary updated
- âœ… Versioning: `test_version: 1` (cÃ³ thá»ƒ cÃ³ v2, v3)

---

## ğŸ“Š Success Metrics

### **KPIs to Track:**

1. **Generation Success Rate**
   - Target: >95% tests generated successfully
   - Failed: Log errors, manual review

2. **Test Completion Rate**
   - Target: >60% users complete test after viewing conversation
   - Measure: `test_submissions` linked to `conversation_id`

3. **Average Score by Level**
   - Beginner: 75-85% (relatively easy)
   - Intermediate: 65-75% (moderate)
   - Advanced: 55-65% (challenging)

4. **User Engagement**
   - Repeat attempts: >30% users retake failed tests
   - Time on test: 8-12 minutes average

5. **Question Quality Score**
   - User feedback: "Was this question helpful?" (thumbs up/down)
   - Target: >80% positive feedback

---

## ğŸš€ Next Steps (Action Items)

### **Phase 1: Prototype (1 week)**
- [ ] Create database migration script
- [ ] Build test generation for 1 conversation (manual test)
- [ ] Test DeepSeek prompt quality
- [ ] Test Gemini image generation (or Figma template)
- [ ] Review generated test with English teacher

### **Phase 2: Batch Generation (2 weeks)**
- [ ] Implement parallel generation script
- [ ] Generate tests for all 1,739 conversations
- [ ] Upload cover images to R2
- [ ] Link tests to conversations
- [ ] Create index for fast queries

### **Phase 3: Frontend Integration (1 week)**
- [ ] Add "Take Test" button in conversation detail page
- [ ] Display test results with score
- [ ] Show vocabulary/grammar explanations after submit
- [ ] Link test score to user progress

### **Phase 4: Analytics & Optimization (ongoing)**
- [ ] Track test completion rates
- [ ] Collect user feedback on questions
- [ ] A/B test different question types
- [ ] Improve DeepSeek prompts based on feedback

---

## ğŸ’¡ Recommendation

### **CÃ“ NÃŠN LÃ€M?** âœ… **STRONGLY RECOMMEND**

**LÃ½ do:**

1. âœ… **Data Ä‘Ã£ sáºµn:** Vocabulary & grammar Ä‘Ã£ Ä‘Æ°á»£c generate bá»Ÿi DeepSeek
2. âœ… **Infrastructure Ä‘Ã£ cÃ³:** Collection `online_tests` hoÃ n chá»‰nh, 67 endpoints
3. âœ… **Value proposition rÃµ rÃ ng:** Há»c conversation â†’ LÃ m test â†’ Cá»§ng cá»‘ kiáº¿n thá»©c
4. âœ… **Scalable:** 1 script cháº¡y 1 láº§n, táº¡o 1,739 tests tá»± Ä‘á»™ng
5. âœ… **Monetization potential:** Free cho learners, cÃ³ thá»ƒ sell á»Ÿ marketplace
6. âœ… **Differentiation:** Ãt app cÃ³ feature nÃ y (conversation-linked tests)

**Risks:**
- âš ï¸ Question quality cáº§n review (giáº£i phÃ¡p: manual review 10 tests Ä‘áº§u)
- âš ï¸ Image generation cost (giáº£i phÃ¡p: template-based hoáº·c lazy loading)
- âš ï¸ User adoption rate uncertain (giáº£i phÃ¡p: A/B test trÆ°á»›c khi generate háº¿t)

**Timeline:** 4 weeks from prototype to production

**Cost Estimate:**
- DeepSeek API: 1,739 tests Ã— $0.01 = **$17.39**
- Gemini Image: 90 unique images Ã— $0.05 = **$4.50** (or $0 if use templates)
- **Total: ~$22** (one-time cost)

**ROI:**
- Increased user engagement â†’ More time on platform
- Higher conversion to premium (if link to premium conversations)
- Marketplace potential (sell tests separately)

---

## ğŸ“ Conclusion

Táº¡o online test tá»« conversation vocabulary & grammar lÃ  má»™t **chiáº¿n lÆ°á»£c tá»‘t** vÃ¬:

1. **Leverages existing data** (vocabulary & grammar Ä‘Ã£ cÃ³)
2. **Enhances learning experience** (reinforcement through testing)
3. **Low implementation cost** ($22 + 4 weeks dev time)
4. **High scalability** (automated generation)
5. **Multiple use cases** (learning, gamification, marketplace)

**Recommended Action:**
- Start with **Phase 1 Prototype** (1 week)
- Test vá»›i **10 conversations** (Ä‘a dáº¡ng levels & topics)
- Collect feedback from **beta users**
- Náº¿u positive â†’ Scale to all 1,739 conversations

---

**Document Version:** 1.0
**Last Updated:** 14/02/2026
**Contact:** GitHub Copilot / WordAI Dev Team
